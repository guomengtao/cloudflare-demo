<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç½‘é¡µåˆ¶ä½œå·¥å…· - ä¸“ä¸šå‡çº§ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            height: 95vh;
        }
        
        .sidebar {
            width: 400px;
            background: #f8f9fa;
            border-right: 1px solid #e9ecef;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .sidebar-header h1 {
            color: #333;
            font-size: 1.8em;
            margin-bottom: 10px;
        }
        
        .sidebar-header p {
            color: #666;
            font-size: 0.9em;
        }
        
        .template-section {
            margin-bottom: 30px;
        }
        
        .template-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .template-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .template-btn {
            padding: 12px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
            text-align: center;
        }
        
        .template-btn:hover {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .template-btn.english {
            background: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
        }
        
        .template-btn.empty {
            background: #51cf66;
            color: white;
            border-color: #51cf66;
        }
        
        .requirements-section {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .requirements-section h3 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .requirements-input {
            flex: 1;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
            min-height: 300px;
            font-family: 'Courier New', monospace;
            line-height: 1.5;
        }
        
        .additional-input-section {
            margin-top: 20px;
        }
        
        .additional-input-section h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .additional-input {
            width: 100%;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
            min-height: 120px;
            font-family: 'Courier New', monospace;
            line-height: 1.5;
        }
        
        .demo-section {
            margin-top: 20px;
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
        }
        
        .demo-section h3 {
            color: #856404;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .demo-content {
            font-size: 12px;
            line-height: 1.4;
            color: #856404;
            max-height: 200px;
            overflow-y: auto;
            background: #fff;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ffeaa7;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .chat-header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .chat-header h2 {
            font-size: 1.8em;
            margin-bottom: 5px;
        }
        
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #fafafa;
        }
        
        .message {
            margin-bottom: 25px;
            max-width: 90%;
        }
        
        .user-message {
            margin-left: auto;
            background: #007bff;
            color: white;
            padding: 15px 20px;
            border-radius: 18px 18px 4px 18px;
        }
        
        .ai-message {
            background: white;
            color: #333;
            padding: 0;
            border-radius: 18px 18px 18px 4px;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .message-content {
            padding: 20px;
        }
        
        .html-code-section {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 0;
            border-top: 1px solid #333;
        }
        
        .html-header {
            background: #2d2d30;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
        }
        
        .html-title {
            font-weight: 600;
            color: #fff;
        }
        
        .code-actions {
            display: flex;
            gap: 10px;
        }
        
        .code-btn {
            padding: 5px 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            transition: background 0.3s;
        }
        
        .code-btn:hover {
            background: #0056b3;
        }
        
        .code-btn.secondary {
            background: #6c757d;
        }
        
        .code-btn.secondary:hover {
            background: #545b62;
        }
        
        .html-code {
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
            max-height: 500px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .preview-section {
            background: white;
            border-top: 1px solid #e9ecef;
            padding: 0;
        }
        
        .preview-header {
            background: #f8f9fa;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e9ecef;
        }
        
        .preview-title {
            font-weight: 600;
            color: #333;
        }
        
        .preview-iframe {
            width: 100%;
            height: 400px;
            border: none;
        }
        
        .message-time {
            font-size: 0.8em;
            opacity: 0.7;
            margin-top: 10px;
            color: #666;
        }
        
        .chat-input-container {
            padding: 20px;
            border-top: 1px solid #e9ecef;
            background: white;
        }
        
        .chat-input {
            display: flex;
            gap: 10px;
        }
        
        .message-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .message-input:focus {
            border-color: #007bff;
        }
        
        .send-button {
            background: #007bff;
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 24px;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 600;
        }
        
        .send-button:hover {
            background: #0056b3;
        }
        
        .send-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        
        .typing-indicator {
            display: none;
            padding: 15px 20px;
            background: white;
            border-radius: 18px;
            border: 1px solid #e9ecef;
            max-width: 100px;
            margin-bottom: 20px;
        }
        
        .typing-dots {
            display: flex;
            gap: 4px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background: #666;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }
        
        @media (max-width: 1200px) {
            .container {
                flex-direction: column;
                height: auto;
            }
            
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }
            
            .template-buttons {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .template-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .code-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>ğŸš€ ç½‘é¡µåˆ¶ä½œå·¥å…·</h1>
                <p>ä¸“ä¸šå‡çº§ç‰ˆ - æ”¯æŒå¤§é‡ä¿¡æ¯è¾“å…¥</p>
            </div>
            
            <div class="template-section">
                <h3>ğŸ“‹ å¿«é€Ÿæ¨¡æ¿</h3>
                <div class="template-buttons">
                    <button class="template-btn english" onclick="loadEnglishTemplate()">ç¾å¼çº¯è‹±æ–‡</button>
                    <button class="template-btn empty" onclick="loadEmptyTemplate()">ç©ºæ¨¡æ¿</button>
                    <button class="template-btn" onclick="loadTemplate('landing')">è½åœ°é¡µ</button>
                    <button class="template-btn" onclick="loadTemplate('portfolio')">ä½œå“é›†</button>
                    <button class="template-btn" onclick="loadTemplate('blog')">åšå®¢</button>
                    <button class="template-btn" onclick="loadTemplate('ecommerce')">ç”µå•†</button>
                    <button class="template-btn" onclick="loadTemplate('dashboard')">ä»ªè¡¨æ¿</button>
                    <button class="template-btn" onclick="loadTemplate('contact')">è”ç³»è¡¨å•</button>
                </div>
            </div>
            
            <div class="requirements-section">
                <h3>âœï¸ è¯¦ç»†éœ€æ±‚æè¿°</h3>
                <textarea class="requirements-input" id="requirementsInput" placeholder="è¯·è¯¦ç»†æè¿°æ‚¨çš„ç½‘é¡µéœ€æ±‚ï¼ŒåŒ…æ‹¬ï¼š
â€¢ é¡µé¢ç±»å‹ï¼ˆè½åœ°é¡µã€åšå®¢ã€ç”µå•†ç­‰ï¼‰
â€¢ ä¸»è¦åŠŸèƒ½éœ€æ±‚
â€¢ è®¾è®¡é£æ ¼åå¥½
â€¢ é¢œè‰²æ–¹æ¡ˆ
â€¢ å“åº”å¼è¦æ±‚
â€¢ ç‰¹æ®Šäº¤äº’éœ€æ±‚
â€¢ å†…å®¹ç»“æ„

ç¤ºä¾‹ï¼šæˆ‘éœ€è¦ä¸€ä¸ªç§‘æŠ€å…¬å¸çš„è½åœ°é¡µï¼Œè¦æ±‚ç°ä»£ç®€çº¦é£æ ¼ï¼Œè“è‰²ä¸»é¢˜ï¼ŒåŒ…å«å¯¼èˆªæ ã€è‹±é›„åŒºå—ã€äº§å“ä»‹ç»ã€å›¢é˜Ÿå±•ç¤ºå’Œè”ç³»è¡¨å•ã€‚éœ€è¦æ”¯æŒç§»åŠ¨ç«¯å“åº”å¼å¸ƒå±€ã€‚"></textarea>
            </div>
            
            <div class="additional-input-section">
                <h3>ğŸ“ è¡¥å……è¯´æ˜</h3>
                <textarea class="additional-input" id="additionalInput" placeholder="è¾“å…¥è¡¥å……è¯´æ˜ã€ç‰¹æ®Šè¦æ±‚æˆ–ä¿®æ”¹æ„è§...
æ”¯æŒå¤§é‡æ–‡å­—è¾“å…¥ï¼Œå¯ä»¥è¯¦ç»†æè¿°å…·ä½“éœ€æ±‚ã€‚"></textarea>
            </div>
            
            <div class="demo-section">
                <h3>ğŸ” å¤±è¸ªäººå‘˜å­—æ®µå‚è€ƒ</h3>
                <div class="demo-content" id="missingPersonDemo">
                    Dorothy P. Goroshko 
                    Goroshko, circa 1975; Goroshko's 1970 Ford Maverick; John "Jack" Boulton in the 1960s 
                    Missing Since 06/04/1975 
                    Missing From Boston, Massachusetts 
                    Classification Endangered Missing 
                    Sex Female 
                    Race White 
                    Age 40 years old 
                    Height and Weight 5'6, 130 pounds 
                    Associated Vehicle(s) Gold and black 1970 Ford Maverick with the Massachusetts license plate number 9K7755 
                    Distinguishing Characteristics White female. Blonde hair, brown eyes. Goroshko's maiden name is Carbone. Her hair was shoulder-length at the time of her disappearance, and her ears are pierced. All her teeth have been removed and she wears a full set of dentures. 
                    Details of Disappearance 
                    Goroshko was last seen at The Penalty Box, a bar on Causeway Street in the North Station area of Boston, Massachusetts, on June 4, 1975. She has never been heard from again and her car, a gold and black 1970 Ford Maverick with the Massachusetts license plate number 9K7755, has not been found either. A photo of the car is posted with this case summary. 
                    
                    At the time of her disappearance, Goroshko was dating John "Jack" Boulton, a convicted felon. A photo of him is posted with this case summary. He told police he and Goroshko were out drinking that night, and went to Brighton, Massachusetts together, where they got into an argument and ended their relationship. 
                    
                    He said he walked from Brighton to his family home in Roslindale, Massachusetts, and on the way, Goroshko followed him in her car, yelling and trying to hit him with the car. When he reached the Arnold Arboretum in Jamaica Plain, Massachusetts, he took a shortcut through the park to get away from her. He never saw her again after that. 
                    
                    Authorities stated Boulton's story doesn't match up with other evidence of the night of Goroshko's disappearance, however. He has a violent history, including convictions for armed robbery and the manslaughter of a previous girlfriend's two-year-old daughter, and Goroshko's sons stated he mistreated their mother. 
                    
                    Boulton now lives in Florida. Authorities re-interviewed him about Goroshko's case decades after she disappeared, and he said he had no idea what happened to her. When interviewed by a news reporter in 2019, he described the incident where Goroshko followed him home and tried to hit him with her car, but said that wasn't the night of her disappearance, only the night he himself last saw her. He has not been named as a suspect in her disappearance. 
                    
                    At the time of her disappearance, Goroshko lived in the 50 block of Monastery Road in Brighton, Massachusetts. Her mother died in 1992 and her sister in 2008, and in both their obituaries, Goroshko is listed as having predeceased them. Both police and her sons do not believe she left of her own accord. Her case remains unsolved. 
                    Investigating Agency 
                    Boston Police Department 617-343-4470 
                    Source Information 
                    NamUs 
                    The Boston Globe
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="chat-header">
                <h2>ğŸ’¬ ç½‘é¡µç”ŸæˆåŠ©æ‰‹</h2>
                <p>åŸºäº Gemini AI çš„æ™ºèƒ½ç½‘é¡µåˆ¶ä½œ - å‡çº§ç‰ˆ</p>
            </div>
            
            <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <div class="message ai-message">
                        <div class="message-content">
                            <p>ğŸ‘‹ æ¬¢è¿ä½¿ç”¨ç½‘é¡µåˆ¶ä½œå·¥å…·ä¸“ä¸šå‡çº§ç‰ˆï¼</p>
                            <p>æˆ‘å¯ä»¥æ ¹æ®æ‚¨çš„è¯¦ç»†éœ€æ±‚ç”Ÿæˆå®Œæ•´çš„ HTML ä»£ç ï¼Œå¹¶æä¾›ï¼š</p>
                            <ul>
                                <li>ğŸ“ <strong>å¤§é‡ä¿¡æ¯è¾“å…¥</strong> - æ”¯æŒé•¿ç¯‡è¯¦ç»†æè¿°</li>
                                <li>ğŸ’» <strong>å®Œæ•´çš„ HTML ä»£ç </strong> - è¯­æ³•é«˜äº®æ˜¾ç¤º</li>
                                <li>ğŸ“‹ <strong>ä¸€é”®å¤åˆ¶åŠŸèƒ½</strong> - æ–¹ä¾¿ä»£ç é‡ç”¨</li>
                                <li>ğŸ‘€ <strong>ç‹¬ç«‹é¢„è§ˆçª—å£</strong> - æ–°çª—å£å…¨å±é¢„è§ˆ</li>
                                <li>ğŸ” <strong>å‚è€ƒæ¨¡æ¿</strong> - åŒ…å«å¤±è¸ªäººå‘˜å­—æ®µç¤ºä¾‹</li>
                            </ul>
                            <p>è¯·åœ¨å·¦ä¾§è¾“å…¥æ‚¨çš„è¯¦ç»†éœ€æ±‚ï¼Œæˆ–ç‚¹å‡»æ¨¡æ¿æŒ‰é’®å¿«é€Ÿå¼€å§‹ï¼</p>
                        </div>
                        <div class="message-time" id="welcomeTime"></div>
                    </div>
                </div>
                
                <div class="typing-indicator" id="typingIndicator">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
                
                <div class="chat-input-container">
                    <div class="chat-input">
                        <input type="text" 
                               id="messageInput" 
                               class="message-input" 
                               placeholder="è¾“å…¥è¡¥å……è¯´æ˜æˆ–ä¿®æ”¹è¦æ±‚..."
                               maxlength="5000">
                        <button id="sendButton" class="send-button">ç”Ÿæˆç½‘é¡µ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API é…ç½® - ä½¿ç”¨ Cloudflare Pages Functions ä»£ç†
        const API_CONFIG = {
            baseUrl: '/gemini'
        };

        // DOM å…ƒç´ 
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const requirementsInput = document.getElementById('requirementsInput');
        const additionalInput = document.getElementById('additionalInput');
        const sendButton = document.getElementById('sendButton');
        const typingIndicator = document.getElementById('typingIndicator');
        const welcomeTime = document.getElementById('welcomeTime');
        const missingPersonDemo = document.getElementById('missingPersonDemo');

        // è®¾ç½®æ¬¢è¿æ¶ˆæ¯æ—¶é—´
        welcomeTime.textContent = getCurrentTime();

        // å…è®¸ç¼–è¾‘å¤±è¸ªäººå‘˜å‚è€ƒå†…å®¹
        missingPersonDemo.contentEditable = true;
        missingPersonDemo.style.cursor = 'text';

        // æ¨¡æ¿æ•°æ®
        const templates = {
            landing: `æˆ‘éœ€è¦ä¸€ä¸ªç§‘æŠ€å…¬å¸çš„è½åœ°é¡µï¼Œè¦æ±‚ï¼š
â€¢ ç°ä»£ç®€çº¦è®¾è®¡é£æ ¼
â€¢ è“è‰²ä¸»é¢˜é…è‰²æ–¹æ¡ˆ
â€¢ åŒ…å«ï¼šå¯¼èˆªæ ã€è‹±é›„åŒºå—ã€äº§å“ç‰¹æ€§ã€å®¢æˆ·è¯„ä»·ã€è”ç³»è¡¨å•
â€¢ å®Œå…¨å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯
â€¢ æ·»åŠ é€‚å½“çš„åŠ¨ç”»æ•ˆæœ
â€¢ ä½¿ç”¨ç°ä»£ CSS ç‰¹æ€§ï¼ˆFlexbox/Gridï¼‰`,
            
            portfolio: `ä¸ªäººä½œå“é›†ç½‘ç«™éœ€æ±‚ï¼š
â€¢ åˆ›æ„è®¾è®¡é£æ ¼ï¼Œçªå‡ºä¸ªæ€§
â€¢ æ·±è‰²ä¸»é¢˜ï¼Œæ­é…äº®è‰²ç‚¹ç¼€
â€¢ åŒ…å«ï¼šå…³äºæˆ‘ã€æŠ€èƒ½å±•ç¤ºã€é¡¹ç›®ä½œå“é›†ã€è”ç³»æ–¹å¼
â€¢ ä½œå“é›†éƒ¨åˆ†è¦æœ‰å›¾ç‰‡å±•ç¤ºå’Œé¡¹ç›®æè¿°
â€¢ æ·»åŠ å¹³æ»‘æ»šåŠ¨å’Œè¿‡æ¸¡åŠ¨ç”»
â€¢ ç§»åŠ¨ç«¯å‹å¥½çš„å¯¼èˆªèœå•`,
            
            blog: `æŠ€æœ¯åšå®¢ç½‘ç«™éœ€æ±‚ï¼š
â€¢ ç®€æ´ä¸“ä¸šçš„é˜…è¯»ä½“éªŒ
â€¢ æµ…è‰²ä¸»é¢˜ï¼Œè‰¯å¥½çš„å¯è¯»æ€§
â€¢ åŒ…å«ï¼šæ–‡ç« åˆ—è¡¨ã€æ–‡ç« è¯¦æƒ…é¡µã€åˆ†ç±»æ ‡ç­¾ã€æœç´¢åŠŸèƒ½
â€¢ ä»£ç é«˜äº®æ˜¾ç¤ºæ”¯æŒ
â€¢ å“åº”å¼è®¾è®¡ï¼Œé€‚åˆå„ç§å±å¹•é˜…è¯»
â€¢ ç¤¾äº¤åˆ†äº«åŠŸèƒ½`
        };

        // åŠ è½½æ¨¡æ¿
        function loadTemplate(templateKey) {
            if (templates[templateKey]) {
                requirementsInput.value = templates[templateKey];
                additionalInput.value = '';
                messageInput.placeholder = "è¾“å…¥å¯¹æ¨¡æ¿çš„è¡¥å……è¦æ±‚æˆ–ä¿®æ”¹...";
                showNotification(`å·²åŠ è½½ ${templateKey} æ¨¡æ¿`);
            }
        }

        // åŠ è½½ç¾å¼çº¯è‹±æ–‡æ¨¡æ¿
        function loadEnglishTemplate() {
            requirementsInput.value = `Create a modern American-style website with the following requirements:
â€¢ Clean, professional design with English content only
â€¢ Responsive layout that works on all devices
â€¢ Modern typography and spacing
â€¢ Professional color scheme (blues, grays, or corporate colors)
â€¢ Include: Header with navigation, Hero section, Features/Products, About section, Contact form
â€¢ Optimized for SEO and fast loading
â€¢ Cross-browser compatible
â€¢ Use modern CSS (Flexbox/Grid) and semantic HTML5`;
            additionalInput.value = '';
            messageInput.placeholder = "Enter additional requirements or modifications...";
            showNotification('å·²åŠ è½½ç¾å¼çº¯è‹±æ–‡æ¨¡æ¿');
        }

        // åŠ è½½ç©ºæ¨¡æ¿
        function loadEmptyTemplate() {
            requirementsInput.value = '';
            additionalInput.value = '';
            messageInput.placeholder = "è¯·è¾“å…¥æ‚¨çš„ç½‘é¡µéœ€æ±‚...";
            showNotification('å·²åŠ è½½ç©ºæ¨¡æ¿ï¼Œè¯·è¾“å…¥æ‚¨çš„éœ€æ±‚');
        }

        // å‘é€æ¶ˆæ¯å‡½æ•°
        async function sendMessage() {
            const requirements = requirementsInput.value.trim();
            const additional = additionalInput.value.trim();
            const message = messageInput.value.trim();
            
            if (!requirements && !additional && !message) {
                showNotification('è¯·è¾“å…¥éœ€æ±‚æè¿°');
                return;
            }

            // ç»„åˆå®Œæ•´çš„éœ€æ±‚æè¿°
            let fullMessage = '';
            if (requirements) fullMessage += `ä¸»è¦éœ€æ±‚ï¼š\n${requirements}\n\n`;
            if (additional) fullMessage += `è¡¥å……è¯´æ˜ï¼š\n${additional}\n\n`;
            if (message) fullMessage += `å…·ä½“è¦æ±‚ï¼š\n${message}`;

            // ç¦ç”¨è¾“å…¥å’ŒæŒ‰é’®
            messageInput.disabled = true;
            requirementsInput.disabled = true;
            additionalInput.disabled = true;
            sendButton.disabled = true;

            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            addMessage(fullMessage, 'user');

            // æ¸…ç©ºè¾“å…¥æ¡†
            messageInput.value = '';

            // æ˜¾ç¤ºæ‰“å­—æŒ‡ç¤ºå™¨
            showTypingIndicator();

            try {
                // è°ƒç”¨ Gemini API ç”Ÿæˆç½‘é¡µä»£ç 
                const response = await generateWebpage(fullMessage);
                
                // éšè—æ‰“å­—æŒ‡ç¤ºå™¨
                hideTypingIndicator();
                
                // æ·»åŠ  AI å›å¤ï¼ˆåŒ…å«ä»£ç å’Œé¢„è§ˆï¼‰
                addWebpageResponse(response);
                
            } catch (error) {
                // éšè—æ‰“å­—æŒ‡ç¤ºå™¨
                hideTypingIndicator();
                
                // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
                addMessage(`æŠ±æ­‰ï¼Œç”Ÿæˆç½‘é¡µæ—¶å‡ºç°é”™è¯¯ï¼š${error.message}`, 'ai');
                
                console.error('API è°ƒç”¨é”™è¯¯:', error);
            }

            // é‡æ–°å¯ç”¨è¾“å…¥å’ŒæŒ‰é’®
            messageInput.disabled = false;
            requirementsInput.disabled = false;
            additionalInput.disabled = false;
            messageInput.focus();
        }

        // ç”Ÿæˆç½‘é¡µä»£ç 
        async function generateWebpage(requirements) {
            const prompt = `è¯·æ ¹æ®ä»¥ä¸‹éœ€æ±‚ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„ HTML ç½‘é¡µä»£ç ã€‚è¦æ±‚ï¼š

1. ç”Ÿæˆå®Œæ•´çš„ã€å¯è¿è¡Œçš„ HTML æ–‡ä»¶ä»£ç 
2. åŒ…å«å®Œæ•´çš„ <!DOCTYPE html> å£°æ˜
3. åŒ…å«å®Œæ•´çš„ HTML ç»“æ„ï¼ˆhtml, head, bodyï¼‰
4. åŒ…å«å¿…è¦çš„ CSS æ ·å¼ï¼ˆæ”¾åœ¨ <style> æ ‡ç­¾ä¸­ï¼‰
5. åŒ…å«å¿…è¦çš„ JavaScriptï¼ˆæ”¾åœ¨ <script> æ ‡ç­¾ä¸­ï¼‰
6. ä»£ç è¦ç¾è§‚ã€è§„èŒƒã€æœ‰æ³¨é‡Š
7. ç¡®ä¿ä»£ç å¯ä»¥ç›´æ¥å¤åˆ¶è¿è¡Œ
8. æ”¯æŒå“åº”å¼è®¾è®¡
9. ä½¿ç”¨ç°ä»£ CSS ç‰¹æ€§

ç”¨æˆ·éœ€æ±‚ï¼š${requirements}

è¯·ç›´æ¥è¿”å›å®Œæ•´çš„ HTML ä»£ç ï¼Œä¸è¦é¢å¤–çš„è§£é‡Šæ–‡å­—ã€‚`;

            const response = await fetch(API_CONFIG.baseUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{ text: prompt }]
                    }]
                })
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            
            if (data.error) {
                throw new Error(data.error);
            }
            
            if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                return data.candidates[0].content.parts[0].text;
            } else {
                throw new Error('æ— æ•ˆçš„ API å“åº”æ ¼å¼');
            }
        }

        // æ·»åŠ ç½‘é¡µç”Ÿæˆå“åº”
        function addWebpageResponse(htmlCode) {
            // æå–çº¯ HTML ä»£ç ï¼ˆå»é™¤å¯èƒ½çš„è¯´æ˜æ–‡å­—ï¼‰
            const cleanHtmlCode = extractHtmlCode(htmlCode);
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ai-message';
            
            // æ¶ˆæ¯å†…å®¹éƒ¨åˆ†
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            messageContent.innerHTML = `
                <p>âœ… ç½‘é¡µä»£ç å·²ç”Ÿæˆå®Œæˆï¼</p>
                <p>ä»¥ä¸‹æ˜¯æ ¹æ®æ‚¨çš„éœ€æ±‚ç”Ÿæˆçš„å®Œæ•´ HTML ä»£ç ï¼š</p>
                <ul>
                    <li>ğŸ“„ <strong>å®Œæ•´ HTML ç»“æ„</strong> - åŒ…å«æ‰€æœ‰å¿…è¦æ ‡ç­¾</li>
                    <li>ğŸ¨ <strong>å†…è” CSS æ ·å¼</strong> - æ— éœ€å¤–éƒ¨æ–‡ä»¶</li>
                    <li>âš¡ <strong>å“åº”å¼è®¾è®¡</strong> - æ”¯æŒç§»åŠ¨ç«¯</li>
                    <li>ğŸ“± <strong>ç‹¬ç«‹é¢„è§ˆ</strong> - æ–°çª—å£å…¨å±æŸ¥çœ‹</li>
                </ul>
                <p style="color: #666; font-size: 0.9em; margin-top: 10px;">
                    ğŸ’¡ æç¤ºï¼šç‚¹å‡»"é¢„è§ˆ"æŒ‰é’®åœ¨æ–°çª—å£ä¸­æŸ¥çœ‹å®Œæ•´æ•ˆæœ
                </p>
            `;
            
            // HTML ä»£ç éƒ¨åˆ†
            const htmlSection = document.createElement('div');
            htmlSection.className = 'html-code-section';
            
            const htmlHeader = document.createElement('div');
            htmlHeader.className = 'html-header';
            htmlHeader.innerHTML = `
                <span class="html-title">ğŸ“„ ç”Ÿæˆçš„ HTML ä»£ç </span>
                <div class="code-actions">
                    <button class="code-btn secondary" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶ä»£ç </button>
                    <button class="code-btn" onclick="openPreview()">ğŸ‘€ é¢„è§ˆ</button>
                </div>
            `;
            
            const htmlCodeElement = document.createElement('pre');
            htmlCodeElement.className = 'html-code';
            htmlCodeElement.textContent = cleanHtmlCode;
            htmlCodeElement.id = 'generatedCode';
            
            htmlSection.appendChild(htmlHeader);
            htmlSection.appendChild(htmlCodeElement);
            
            // æ—¶é—´æˆ³
            const messageTime = document.createElement('div');
            messageTime.className = 'message-time';
            messageTime.textContent = getCurrentTime();
            
            // ç»„è£…æ¶ˆæ¯
            messageDiv.appendChild(messageContent);
            messageDiv.appendChild(htmlSection);
            messageDiv.appendChild(messageTime);
            
            chatMessages.appendChild(messageDiv);
            
            // æ»šåŠ¨åˆ°åº•éƒ¨
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // æå–çº¯ HTML ä»£ç 
        function extractHtmlCode(text) {
            // å°è¯•æå– ```html ä»£ç å—
            const htmlBlockMatch = text.match(/```html\n([\s\S]*?)\n```/);
            if (htmlBlockMatch) {
                return htmlBlockMatch[1];
            }
            
            // å°è¯•æå– ``` ä»£ç å—
            const codeBlockMatch = text.match(/```\n([\s\S]*?)\n```/);
            if (codeBlockMatch) {
                return codeBlockMatch[1];
            }
            
            // å¦‚æœæ²¡æœ‰ä»£ç å—æ ‡è®°ï¼Œè¿”å›åŸå§‹æ–‡æœ¬
            return text;
        }

        // å¤åˆ¶ä»£ç 
        function copyCode(button) {
            const code = document.getElementById('generatedCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                const originalText = button.textContent;
                button.textContent = 'âœ… å·²å¤åˆ¶';
                setTimeout(() => {
                    button.textContent = originalText;
                }, 2000);
            });
        }

        // æ‰“å¼€ç‹¬ç«‹é¢„è§ˆ
        function openPreview() {
            const code = document.getElementById('generatedCode').textContent;
            const previewWindow = window.open('', '_blank', 'width=1200,height=800,scrollbars=yes');
            previewWindow.document.write(code);
            previewWindow.document.close();
            previewWindow.focus();
        }

        // æ·»åŠ æ™®é€šæ¶ˆæ¯
        function addMessage(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            const messageContent = document.createElement('div');
            messageContent.textContent = text;
            
            const messageTime = document.createElement('div');
            messageTime.className = 'message-time';
            messageTime.textContent = getCurrentTime();
            
            messageDiv.appendChild(messageContent);
            messageDiv.appendChild(messageTime);
            chatMessages.appendChild(messageDiv);
            
            // æ»šåŠ¨åˆ°åº•éƒ¨
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // æ˜¾ç¤ºæ‰“å­—æŒ‡ç¤ºå™¨
        function showTypingIndicator() {
            typingIndicator.style.display = 'block';
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // éšè—æ‰“å­—æŒ‡ç¤ºå™¨
        function hideTypingIndicator() {
            typingIndicator.style.display = 'none';
        }

        // è·å–å½“å‰æ—¶é—´
        function getCurrentTime() {
            return new Date().toLocaleTimeString('zh-CN', {
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message) {
            // åˆ›å»ºè‡ªå®šä¹‰é€šçŸ¥
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #007bff;
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-size: 14px;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 3000);
        }

        // äº‹ä»¶ç›‘å¬å™¨
        sendButton.addEventListener('click', sendMessage);
        
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // é¡µé¢åŠ è½½åè‡ªåŠ¨èšç„¦è¾“å…¥æ¡†
        window.addEventListener('load', () => {
            messageInput.focus();
        });
    </script>
</body>
</html>