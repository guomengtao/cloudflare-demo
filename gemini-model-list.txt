// æœ€å°çš„å‘½ä»¤è¡Œå·¥å…·ï¼šè°ƒç”¨Cloudflare AIæœåŠ¡
const fetch = require('node-fetch');

// é»˜è®¤é—®é¢˜
const DEFAULT_QUESTION = 'ç°åœ¨æ˜¯ä»€ä¹ˆæ—¶é—´ï¼Ÿ';

// Cloudflare AI API ç«¯ç‚¹
const AI_ENDPOINT = 'http://localhost:8787/api/ai-chat';

// é»˜è®¤æ¨¡å‹
const DEFAULT_MODEL = '@cf/meta/llama-3.1-8b-instruct';

// ä¸»å‡½æ•°
async function main() {
    try {
        // è·å–ç”¨æˆ·è¾“å…¥çš„é—®é¢˜ï¼Œæ²¡æœ‰åˆ™ä½¿ç”¨é»˜è®¤é—®é¢˜
        const question = process.argv[2] || DEFAULT_QUESTION;
        
        console.log(`ğŸ¤– æ­£åœ¨å‘Cloudflare AIæé—®: "${question}"`);
        
        // å‘é€è¯·æ±‚åˆ°Cloudflare AI API
        const response = await fetch(AI_ENDPOINT, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                message: question,
                model: DEFAULT_MODEL
            }),
            timeout: 30000 // 30ç§’è¶…æ—¶
        });
        
        if (!response.ok) {
            throw new Error(`HTTPé”™è¯¯! çŠ¶æ€ç : ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.error) {
            throw new Error(`APIé”™è¯¯: ${data.error}`);
        }
        
        // æ˜¾ç¤ºAIçš„å›ç­”
        console.log('\nâœ¨ AIå›ç­”:');
        console.log(data.response);
        
        // æ˜¾ç¤ºä½¿ç”¨çš„æ¨¡å‹
        console.log(`\nâ„¹ï¸ ä½¿ç”¨çš„æ¨¡å‹: ${data.model || DEFAULT_MODEL}`);
        
    } catch (error) {
        console.error(`âŒ å‘ç”Ÿé”™è¯¯: ${error.message}`);
        process.exit(1);
    }
}

// æ‰§è¡Œä¸»å‡½æ•°
main();


curl https://api.cloudflare.com/client/v4/accounts/197ff91e7b8164532e5a54f708eb14a0/ai/run/@cf/meta/llama-3.2-3b-instruct \
  -H "Authorization: Bearer YR1t_IFpI" \
  -d '{ "prompt": "ä½ å¥½ï¼Œå¦‚æœä½ æ”¶åˆ°äº†è¿™æ¡æ¶ˆæ¯ï¼Œè¯·åªå›å¤ä¸¤ä¸ªå­—ï¼šæ”¶åˆ°ã€‚" }'